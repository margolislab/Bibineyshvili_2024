library("lmerTest")
library("multcomp")
library("emmeans")
library("readxl")
options(max.print=1000000)


X2P_TBI_data<- read_excel("GitHub/Bibineyshvili_2019/2P_TBI_data.xlsx", 
                                       col_types = c("numeric", "numeric", "numeric", 
                                                     "numeric", "numeric", "numeric", 
                                                     "numeric", "numeric"))

X2P_TBI_data$Time = as.factor(X2P_TBI_data$Time)
X2P_TBI_data$Mouse = as.factor(X2P_TBI_data$Mouse)
X2P_TBI_data$Injury = as.factor(X2P_TBI_data$Injury)


results = lmer(Spon_Num ~ Time + (1|Mouse), data = X2P_TBI_data)
anova(results, type = "I")
summary(glht(results, emm(pairwise ~ Time)), test = adjusted("none"))


results = lmer(Spon_Freq ~ Time + (1|Mouse), data = X2P_TBI_data)
anova(results, type = "I")




results = lmer(Spon_Amp ~ Time + (1|Mouse), data = X2P_TBI_data)
anova(results, type = "I")




results = lmer(Wh_Num ~ Time + (1|Mouse), data = X2P_TBI_data)
anova(results, type = "I")


summary(glht(results, emm(pairwise ~ Time)), test = adjusted("holm"))

# Estimate Std. Error t value Pr(>|t|)   
# (-7) - (-6) == 0      6.8030     2.7862   2.442  0.63452   
# (-7) - (-4) == 0      3.8434     2.6849   1.431  1.00000   
# (-7) - (-0.02) == 0   7.5424     2.9114   2.591  0.44851   
# (-7) - 0.02 == 0     12.0985     2.9144   4.151  0.00553 **
# (-7) - 0.1 == 0       8.4318     2.9144   2.893  0.21270   
# (-7) - 1 == 0        11.0000     2.7628   3.981  0.00936 **
# (-7) - 3 == 0         8.8585     2.7847   3.181  0.09987 . 
# (-7) - 7 == 0         9.9809     2.7834   3.586  0.03156 * 
# (-7) - 14 == 0       12.6883     2.7834   4.559  0.00146 **
# (-6) - (-4) == 0     -2.9596     2.6860  -1.102  1.00000   
# (-6) - (-0.02) == 0   0.7394     2.9136   0.254  1.00000   
# (-6) - 0.02 == 0      5.2955     2.8878   1.834  1.00000   
# (-6) - 0.1 == 0       1.6289     2.8878   0.564  1.00000   
# (-6) - 1 == 0         4.1970     2.7862   1.506  1.00000   
# (-6) - 3 == 0         2.0555     2.7863   0.738  1.00000   
# (-6) - 7 == 0         3.1779     2.7849   1.141  1.00000   
# (-6) - 14 == 0        5.8853     2.7849   2.113  1.00000   
# (-4) - (-0.02) == 0   3.6990     2.8127   1.315  1.00000   
# (-4) - 0.02 == 0      8.2551     2.8149   2.933  0.19587   
# (-4) - 0.1 == 0       4.5884     2.8149   1.630  1.00000   
# (-4) - 1 == 0         7.1566     2.6849   2.665  0.38001   
# (-4) - 3 == 0         5.0151     2.6849   1.868  1.00000   
# (-4) - 7 == 0         6.1375     2.6840   2.287  0.89748   
# (-4) - 14 == 0        8.8449     2.6840   3.295  0.07349 . 
# (-0.02) - 0.02 == 0   4.5561     3.0410   1.498  1.00000   
# (-0.02) - 0.1 == 0    0.8894     3.0410   0.292  1.00000   
# (-0.02) - 1 == 0      3.4576     2.9114   1.188  1.00000   
# (-0.02) - 3 == 0      1.3161     2.8867   0.456  1.00000   
# (-0.02) - 7 == 0      2.4385     2.9098   0.838  1.00000   
# (-0.02) - 14 == 0     5.1458     2.9098   1.768  1.00000   
# 0.02 - 0.1 == 0      -3.6667     2.9842  -1.229  1.00000   
# 0.02 - 1 == 0        -1.0985     2.9144  -0.377  1.00000   
# 0.02 - 3 == 0        -3.2400     2.9146  -1.112  1.00000   
# 0.02 - 7 == 0        -2.1176     2.9128  -0.727  1.00000   
# 0.02 - 14 == 0        0.5898     2.9128   0.202  1.00000   
# 0.1 - 1 == 0          2.5682     2.9144   0.881  1.00000   
# 0.1 - 3 == 0          0.4266     2.9146   0.146  1.00000   
# 0.1 - 7 == 0          1.5490     2.9128   0.532  1.00000   
# 0.1 - 14 == 0         4.2564     2.9128   1.461  1.00000   
# 1 - 3 == 0           -2.1415     2.7847  -0.769  1.00000   
# 1 - 7 == 0           -1.0191     2.7834  -0.366  1.00000   
# 1 - 14 == 0           1.6883     2.7834   0.607  1.00000   
# 3 - 7 == 0            1.1224     2.7834   0.403  1.00000   
# 3 - 14 == 0           3.8298     2.7834   1.376  1.00000   
# 7 - 14 == 0           2.7074     2.7822   0.973  1.00000   
# ---
#   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# (Adjusted p values reported -- holm method)


results = lmer(Wh_Amp ~ Time + (1|Mouse), data = X2P_TBI_data)
anova(results, type = "I")
# Type I Analysis of Variance Table with Satterthwaite's method
#       Sum Sq  Mean Sq NumDF  DenDF F value Pr(>F)
# Time 0.66646 0.074051     9 43.083  0.5318 0.8432
